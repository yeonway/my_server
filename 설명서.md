# 프로젝트 설명

`my_server`는 Node.js(Express)와 MongoDB를 기반으로 하는 커뮤니티/업무용 웹 애플리케이션입니다. 사용자 인증, 게시판, 실시간 채팅, 알림, 관리자 콘솔 등을 제공하며 Socket.IO로 실시간 이벤트를 처리합니다. 정적 리소스는 `public/` 디렉터리에서 서빙되고, REST API는 `routes/` 하위 라우터로 구성됩니다. 추가로 공지/문의 대응 문서(`docs/`), 금칙어 검사용 ML 서비스(`ml/`), 폐기된 UI 시안(`폐기/`) 등이 레포지토리 루트에 공존합니다.

## 사전 준비
- Node.js 18 LTS 이상과 npm
- 로컬 MongoDB 인스턴스 (`mongodb://localhost:27017/my_server`)
- `.env` 파일에 필수 환경 변수 정의  
  - `MONGO_URI`, `JWT_SECRET`, `CORS_ORIGINS`, `SIGNUP_LIMIT_BYPASS_IPS` 등

## 실행 방법
1. 의존성 설치: `npm install`
2. MongoDB 실행 후 환경 변수 파일(`.env` 또는 `.env.local`) 준비
3. 개발 실행: `npx nodemon server.js` (또는 `npm start`)
4. 브라우저 접속: `http://localhost:3000/`
   - 최초 `admin` 계정 로그인 시 자동으로 `superadmin` 권한 부여

## 핵심 기능 요약
- **인증/사용자 관리**
  - 회원가입/로그인/로그아웃, JWT 세션 갱신
  - 로그인 실패 잠금(`config/loginLock.js`), 프로필/비밀번호 수정
  - 사용자 차단, 신고, 가입 순서 추적
- **게시판**
  - 글 작성·수정·삭제, 이미지 업로드, 신고 처리, 백업(`models/backupPost.js`)
  - 검색/필터 기능, 게시글 통계(`models/statistic.js`)
- **실시간 채팅**
  - 1:1 및 그룹 채팅, 채팅방 참여/차단, 메시지 편집 히스토리
  - 멘션/DM 알림(`services/notificationService.js`), 차단 로직(`utils/blocking.js`)
- **관리자 도구**
  - 활동 로그(`models/adminActivity.js`), IP/계정 차단, 공지/게시물 관리
  - 설정/프로필/문의/신고 처리 라우터
- **알림 시스템**
  - 실시간 푸시(Socket.IO) + REST API
  - DM, 멘션, 시스템 알림 기록 및 읽음 처리
- **유틸리티 스크립트**
  - 금칙어 가져오기, 게시글 백업, 이미지 마이그레이션, MongoDB 인덱스 생성

## 폴더 구조 개요
```
my_server/
|-- server.js                # Express 부트스트랩 + Socket.IO 초기화
|-- config/                  # DB 연결, 보안/세션/환경 설정, 로거 정의
|-- middleware/              # 인증, 콘텐츠 필터링 미들웨어
|-- models/                  # 사용자/게시글/채팅/통계 등 Mongoose 스키마
|-- routes/                  # auth, posts, chat, admin, calendar 등 REST 라우터
|-- services/                # 알림, 계정 보안, 캘린더, 금칙어 분류 서비스
|-- utils/                   # 스케줄러, 차단 로직, 로그 요약, 달력 백업
|-- scripts/                 # 금칙어/백업/마이그레이션/인덱스 스크립트
|-- public/                  # HTML, CSS, JS, 아이콘, 정적 업로드
|   |-- css/                 # 공통/페이지별 스타일
|   |-- js/                  # 프런트엔드 로직 (account, dashboard, polls 등)
|   |-- uploads/             # 정적 샘플 업로드 파일
|-- docs/                    # 보안, 문의, 알림센터 내부 문서
|-- logs/                    # 애플리케이션/사용자 로그 디렉터리
|-- ml/                      # KorCen 욕설/금칙어 분류 Python 서비스
|-- uploads/                 # 런타임 업로드 저장소 (정적 public/uploads와 분리)
|-- 폐기/                    # 미사용된 페이지 시안(학교 관련 HTML/JS)
|-- package.json             # npm 스크립트 및 의존성
|-- package-lock.json
|-- README.md, 설명서.md
|-- c…account-manager.js 등  # Windows 경로가 섞인 임시 백업 스크립트
```

> **참고**: 루트에 존재하는 `cUsersHOME…` 형태의 파일은 Windows 환경에서 추출된 프런트엔드 자산 백업본입니다. 정식 자산은 `public/js/` 하위 파일을 사용하며, 백업본은 필요 시 비교/이전용으로만 참조합니다.

## 주요 파일 안내
- `server.js`: Express 앱 초기화, Socket.IO 구성, 라우터/정적 자원 등록
- `config/logger.js`, `config/userLogger.js`: 애플리케이션·사용자별 로그 설정
- `middleware/auth.js`: JWT 인증, 세션 검사, 권한 체크
- `routes/` 하위 라우터: `auth`, `users`, `posts`, `chat`, `admin`, `dashboard`, `calendar`, `polls`, `notifications`, `inquiry`, `report`, `setting`, `profile` 등
- `services/notificationService.js`: 알림 생성/전송/멘션 탐지
- `services/korcenClassifier.js`, `ml/korcen_service.py`: 외부 Python 서비스와 연계해 금칙어/혐오 표현을 탐지
- `models/`: 사용자, 게시글, 채팅방, 메시지, 신고, 문의, 금칙어, 통계, 캘린더 등 도메인 모델

## 운영 및 유지보수 팁
- `logs/` 디렉터리에서 애플리케이션 및 사용자 활동을 추적하고 이슈 분석에 활용합니다.
- 새 기능은 라우터·모델·프런트(JS/HTML/CSS)를 함께 수정해야 하며, 권한 체크와 로깅을 병행하세요.
- MongoDB 인덱스가 필요하면 `node scripts/create_indexes.js`를 실행하고 결과를 확인합니다.
- 금칙어/백업/마이그레이션 스크립트는 필요 시 개별적으로 실행하며, 실행 전 데이터 백업을 권장합니다.
- Socket.IO 연결 시 JWT가 필요하므로 프런트엔드에서 로그인 토큰을 전달하도록 구현되어야 합니다.

## 다음 단계 제안
1. 핵심 사용자 여정(가입→게시→채팅 등)을 정의하고 UX 개선 우선순위를 도출
2. 관리자 대시보드에 통계·알림·공지 관리 위젯을 추가하여 운영 효율성 향상
3. 테스트 자동화를 도입(`jest` 등)하고, 주요 라우터별 통합 테스트를 작성해 회귀 이슈를 줄입니다.
