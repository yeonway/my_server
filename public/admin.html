?<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>������ ������</title>
  <script src="js/theme.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script defer src="js/auth-helper.js"></script>
  <link rel="stylesheet" href="css/admin.css">
  <link rel="stylesheet" href="css/topbar.css">
  <link rel="stylesheet" href="css/site-menu.css">
  <link rel="stylesheet" href="css/responsive.css">
  <link rel="stylesheet" href="css/mobile.css">
  <link rel="stylesheet" href="css/notifications.css">
  <link rel="stylesheet" href="css/profile-menu.css">
  <link rel="stylesheet" href="css/dark-mode.css">
  <link rel="stylesheet" href="css/mobile-responsive.css">
</head>
<body class="admin-page">
  <header class="site-topbar">
    <a href="/index.html" class="site-logo" aria-label="DCOUT Ȩ���� �̵�">
      <span class="logo-accent">DC</span>
      <span class="logo-divider" aria-hidden="true"></span>
      <span class="logo-rest">OUT</span>
    </a>
        <nav class="site-menu" aria-label="�ֿ� �޴�">
      <a href="chat.html">ä��</a>
      <a href="posts.html">�Խ���</a>
      <a href="profile.html">������</a>
      <a href="inquiry.html">�����ϱ�</a>
      <a href="setting.html">����</a>
    </nav>
    <div class="topbar-actions">
      <span data-network-indicator>Online</span>
    </div>
  </header>
  <div class="container">
    <header>
      <h1>������ ������</h1>
      <a href="index.html" class="btn-main">��������</a>
    </header>
    <div class="tabs">
      <button class="tab-button active" onclick="openTab(event, 'dashboard')">��ú���</button>
      <button class="tab-button" onclick="openTab(event, 'users')">����� ����</button>
      <button class="tab-button" onclick="openTab(event, 'posts')">�Խñ� ����</button>
      <button class="tab-button" onclick="openTab(event, 'reports')">�Ű� ����</button>
      <button class="tab-button" onclick="openTab(event, 'inquiries')">���� ����</button>
      <button class="tab-button" onclick="openTab(event, 'forbiddenWords')">������ ����</button>
      <button class="tab-button" onclick="openTab(event, 'chatLogs')">ä�� �α�</button>
      <button class="tab-button" onclick="openTab(event, 'logs')">�ý��� �α�</button>
    </div>
    <!-- ��ú��� -->
    <div id="dashboard" class="tab-content active">
      <div class="dashboard-header">
        <div class="dashboard-header-text">
          <h2>��ú��� ���</h2>
          <p id="dashboardLastUpdated" class="dashboard-meta">-</p>
        </div>
        <div class="dashboard-actions">
          <button type="button" class="dashboard-refresh" id="dashboardRefreshBtn" aria-label="��ú��� ���ΰ�ħ">
            <span class="icon" aria-hidden="true">?</span>
            ���ΰ�ħ
          </button>
        </div>
      </div>
      <div id="dashboardStatus" class="dashboard-status" aria-live="polite"></div>
      <div class="grid-container">
        <div class="card stat-card">
          <div id="totalUsers" class="value">-</div>
          <div class="label">�� �����</div>
          <div id="todayNewUsers" class="sub-value">+0</div>
        </div>
        <div class="card stat-card">
          <div id="totalPosts" class="value">-</div>
          <div class="label">�� �Խñ�</div>
          <div id="todayPosts" class="sub-value">+0</div>
        </div>
        <div class="card stat-card">
          <div id="totalComments" class="value">-</div>
          <div class="label">�� ���</div>
          <div id="todayComments" class="sub-value">+0</div>
        </div>
        <div class="card stat-card">
          <div id="pendingReports" class="value">-</div>
          <div class="label">��� ���� �Ű�</div>
        </div>
      </div>
      <div class="health-grid">
        <div class="card health-card" id="systemHealthCard">
          <div class="card-title-row">
            <h3>�α� ����</h3>
            <span id="healthWindowLabel" class="health-window"></span>
          </div>
          <div id="systemHealthMessage" class="health-message" role="status"></div>
          <div class="health-metrics">
            <div class="metric-line"><span class="metric-label">�� �α�</span><span class="metric-value" id="healthTotal">-</span></div>
            <div class="metric-line"><span class="metric-label">Info</span><span class="metric-value info" id="healthInfo">-</span></div>
            <div class="metric-line"><span class="metric-label">Warn</span><span class="metric-value warn" id="healthWarn">-</span></div>
            <div class="metric-line"><span class="metric-label">Error</span><span class="metric-value error" id="healthErrors">-</span></div>
          </div>
          <div id="healthLatestError" class="latest-error">�ֱ� 24�ð� ������ �����ϴ�.</div>
        </div>
        <div class="card health-card" id="resourceHealthCard">
          <div class="card-title-row">
            <h3>�ý��� �ڿ�</h3>
          </div>
          <div class="health-metrics">
            <div class="metric-line"><span class="metric-label">�α� �뷮</span><span class="metric-value" id="healthLogSize">-</span></div>
            <div class="metric-line"><span class="metric-label">���� ū �α�</span><span class="metric-value" id="healthLogLargest">-</span></div>
            <div class="metric-line"><span class="metric-label">�ý��� ��Ÿ��</span><span class="metric-value" id="healthUptime">-</span></div>
            <div class="metric-line"><span class="metric-label">Load (1/5/15)</span><span class="metric-value" id="healthLoad">-</span></div>
            <div class="metric-line"><span class="metric-label">�޸� ���</span><span class="metric-value" id="healthMemory">-</span></div>
          </div>
        </div>
        <div class="card health-card compact-card" id="pendingReportsCard">
          <div class="card-title-row">
            <h3>��� ���� �Ű�</h3>
            <button type="button" class="text-button" id="viewAllReportsBtn">��ü ����</button>
          </div>
          <ul class="mini-list" id="pendingReportsList"></ul>
        </div>
      </div>
      <div class="card">
        <h2>�ֱ� 7�� Ȱ��</h2>
        <div class="chart-container">
          <canvas id="activityChart"></canvas>
        </div>
      </div>
    </div>
    <!-- ����� ���� -->
    <div id="users" class="tab-content">
      <div class="card">
        <h2>����� ���</h2>
        <div class="search-container">
          <input type="text" id="userSearchInput" placeholder="����ڸ����� �˻�..." onkeypress="if(event.key==='Enter') loadUsers()">
          <button onclick="loadUsers()">�˻�</button>
        </div>
        <div class="search-container" style="margin-top: 10px;">
          <input type="text" id="userLogSearchInput" placeholder="����� ID �Ǵ� �̸����� �α� �˻�...">
          <button onclick="searchUserLogs()">�α� ����</button>
        </div>
        <div class="search-container user-sort-container">
          <div class="sort-select-group">
            <label for="userSortField">���� ����</label>
            <select id="userSortField">
              <option value="createdAt">������</option>
              <option value="role">����</option>
            </select>
          </div>
          <button type="button" id="userSortOrderBtn" class="sort-order-btn" data-order="desc">��������</button>
        </div>
        <div class="admin-toolbar">
          <button type="button" id="openAdminPermissionModalBtn" class="action-btn btn-resolve">�� ������ ����</button>
        </div>
        <div id="userMeta" class="user-meta"></div>
        <div class="add-word-container search-row">
          <input type="text" id="forbiddenWordSearchInput" placeholder="?????? ???..." onkeypress="onForbiddenWordSearchKey(event)">
          <div class="search-btn-group">
            <button onclick="searchForbiddenWords(1)">???</button>
            <button class="reset-btn" onclick="resetForbiddenWordSearch()">????</button>
          </div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>���� ����</th>
              <th>����</th>
              <th>�޸�</th>
              <th>������</th>
              <th>����</th>
            </tr>
          </thead>
          <tbody id="userList"></tbody>
        </table>
        <div id="userPagination" class="pagination"></div>
      </div>
    </div>
    <!-- �Խñ� ���� -->
    <div id="posts" class="tab-content">
      <div class="card">
        <h2>�Խñ� ���</h2>
        <div class="search-container">
          <input type="text" id="postSearchInput" placeholder="���� �Ǵ� �������� �˻�..." onkeypress="if(event.key==='Enter') loadPosts()">
          <button onclick="loadPosts()">�˻�</button>
          <button onclick="openNoticeModal()" style="margin-left: 10px; background-color: var(--success-color);">���� �ۼ�</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>����</th>
              <th>�ۼ���</th>
              <th>�ۼ���</th>
              <th>����</th>
              <th>����</th>
              <th>����</th>
            </tr>
          </thead>
          <tbody id="postList"></tbody>
        </table>
      </div>
    </div>
    <!-- �Ű� ���� -->
    <div id="reports" class="tab-content">
      <div class="card">
        <h2>�Ű� ����</h2>
        <div class="filter-buttons" id="reportStatusFilter">
          <button class="filter-btn active" data-status="pending">�����</button>
          <button class="filter-btn" data-status="resolved">�ذ��</button>
          <button class="filter-btn" data-status="dismissed">�Ⱒ��</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>�Ű���</th>
              <th>�Ű���</th>
              <th>�Ű� ���</th>
              <th>�Ű� ����</th>
              <th>����</th>
              <th>����</th>
            </tr>
          </thead>
          <tbody id="reportList"></tbody>
        </table>
      </div>
    </div>
    <!-- ���� ���� -->
    <div id="inquiries" class="tab-content">
      <div class="card">
        <h2>���� ����</h2>
        <div class="filter-buttons" id="inquiryStatusFilter">
          <button class="filter-btn active" data-status="open">�����</button>
          <button class="filter-btn" data-status="closed">ó���Ϸ�</button>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>������</th>
                <th>�ۼ���</th>
                <th>����</th>
                <th>����/����</th>
                <th>����</th>
              </tr>
            </thead>
            <tbody id="inquiryList"></tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- ������ ���� -->
    <div id="forbiddenWords" class="tab-content">
      <div class="card">
        <h2>������ ����</h2>
        <div class="add-word-container">
          <input type="text" id="forbiddenWordInput" placeholder="�߰��� ������ �Է�..." onkeypress="if(event.key==='Enter') addForbiddenWord()">
          <button onclick="addForbiddenWord()">�߰�</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>������</th>
              <th>�����</th>
              <th>�����</th>
              <th>����</th>
            </tr>
          </thead>
          <tbody id="forbiddenWordList"></tbody>
        </table>
        <div id="forbiddenWordPagination" class="pagination"></div>
      </div>
    </div>
    <!-- �ý��� �α� -->
    <!-- ä�� �α� -->
    <div id="chatLogs" class="tab-content">
      <div class="card">
        <h2>ä�� �α�</h2>
        <div class="log-controls">
          <select id="chatLogFileSelect"></select>
          <input type="text" id="chatLogSearchInput" placeholder="�ۼ��� �˻�...">
        </div>
        <div class="chat-log-filters">
          <input type="text" id="chatLogRoomFilter" placeholder="�� ID �˻�...">
          <input type="text" id="chatLogUserFilter" placeholder="�ۼ��� �˻�...">
          <select id="chatLogTypeFilter">
            <option value="all">��ü ����</option>
            <option value="text">�ؽ�Ʈ</option>
            <option value="image">�̹���</option>
            <option value="file">����</option>
          </select>
        </div>
        <table>
          <thead>
            <tr>
              <th>�ð�</th>
              <th>ä��</th>
              <th>��</th>
              <th>���� ���</th>
              <th>����</th>
              <th>����</th>
              <th>����</th>
            </tr>
          </thead>
          <tbody id="chatLogList"></tbody>
        </table>
      </div>
    </div>
    <div id="logs" class="tab-content">
      <div class="card">
        <h2>�ý��� �α�</h2>
        <div class="log-controls">
          <select id="logFileSelect"></select>
          <div class="filter-buttons" id="logLevelFilter">
            <button class="filter-btn active" data-level="all">All</button>
            <button class="filter-btn" data-level="info">Info</button>
            <button class="filter-btn" data-level="warn">Warn</button>
            <button class="filter-btn" data-level="error">Error</button>
          </div>
          <input type="text" id="logSearchInput" placeholder="�α� ���� �˻�...">
        </div>
        <table>
          <thead>
            <tr>
              <th>�ð�</th>
              <th>����</th>
              <th>�޽���</th>
            </tr>
          </thead>
          <tbody id="logList"></tbody>
        </table>
        <div id="systemLogPagination" class="pagination"></div>
      </div>
    </div>
  </div>
  <!-- ����� �α� ��� -->
  <div id="userLogModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="userLogModalTitle">����� �α�</h3>
        <button class="modal-close-btn" onclick="closeUserLogModal()">&times;</button>
      </div>
      <div class="modal-body">
        <table>
          <thead>
            <tr>
              <th>�ð�</th>
              <th>����</th>
              <th>Ȱ�� ����</th>
            </tr>
          </thead>
          <tbody id="userLogList"></tbody>
        </table>
        <div id="userLogPagination" class="pagination"></div>
      </div>
    </div>
  </div>
  <!-- ���� �ۼ� ��� -->
  <div id="noticeModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h3>�� ���� �ۼ�</h3>
        <button class="modal-close-btn" onclick="closeNoticeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <input type="text" id="noticeTitle" placeholder="���� ����">
        <textarea id="noticeContent" placeholder="���� ����"></textarea>
        <div class="file-input-wrapper">
          <input type="file" id="noticeFiles" multiple class="file-input-hidden">
          <label for="noticeFiles" class="file-input-label">���� ����</label>
          <span id="fileNameDisplay" class="file-name-display">���õ� ���� ����</span>
        </div>
      </div>
      <div style="text-align: right; margin-top: 15px;">
        <button class="action-btn btn-dismiss" onclick="closeNoticeModal()">���</button>
        <button class="action-btn btn-resolve" onclick="createNotice()">����</button>
      </div>
    </div>
  </div>
  <!-- ������ ���� ��� -->
  <div id="adminPermissionModal" class="modal-overlay">
    <div class="modal-content admin-permission-modal">
      <div class="modal-header">
        <h3>������ ���� ����</h3>
        <button class="modal-close-btn" onclick="closeAdminPermissionModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <label for="adminPermissionUserSearchInput">����� �˻�</label>
          <div class="modal-search-row">
            <input type="text" id="adminPermissionUserSearchInput" placeholder="����ڸ� �Ǵ� ID">
            <button type="button" id="adminPermissionUserSearchBtn" class="action-btn btn-view">�˻�</button>
          </div>
          <div id="adminPermissionUserSearchResults" class="modal-search-results"></div>
        </div>
        <div id="adminPermissionSelection" class="admin-permission-selection" hidden>
          <div class="selected-user-summary">
            <span id="adminPermissionSelectedUser">���õ� ����ڰ� �����ϴ�.</span>
          </div>
          <div class="modal-section role-select-row">
            <label for="adminRoleSelect">������ ����</label>
            <select id="adminRoleSelect">
              <option value="admin">������</option>
              <option value="manager">�Ŵ���</option>
            </select>
            <p class="modal-help">�ο��� ���ѿ� ���� ���� ������ ����� �޶����ϴ�.</p>
          </div>
          <div class="modal-section">
            <div class="permission-toolbar">
              <button type="button" id="adminPermissionSelectAllBtn" class="action-btn btn-view">��ü ����</button>
            </div>
            <div id="adminPermissionOptionList" class="permission-checkbox-grid"></div>
          </div>
          <div id="adminPermissionStatus" class="modal-status" role="alert"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" id="adminPermissionRemoveBtn" class="action-btn btn-delete">������ ����</button>
        <div class="modal-footer-actions">
          <button type="button" class="action-btn btn-dismiss" onclick="closeAdminPermissionModal()">���</button>
          <button type="button" id="adminPermissionSaveBtn" class="action-btn btn-resolve">����</button>
        </div>
      </div>
    </div>
  </div>
  <!-- ������ �˸� ���� -->
  <div id="admin-alert" style="display:none; position:fixed; top:30px; right:30px; z-index:2000;">
    <span id="admin-alert-msg"></span>
    <button onclick="hideAdminAlert()" style="background:none; border:none; font-size:1.3rem;">&times;</button>
  </div>
  <script defer src="js/auth-helper.js"></script>
  <script defer src="js/notifications.js"></script>
  <script defer src="js/profile-menu.js"></script>
  <script defer src="js/pwa.js"></script>
  <script defer src="js/topbar-dock.js"></script>
  <script defer src="js/admin.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</body>
</html>
